<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Resume Generator</title>
    <link rel="stylesheet" href="create.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

</head>

<body>
    <section class="create">
        <header class="navbar">
            <button class="menu-toggle" id="mobile-menu" aria-label="Toggle Menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <img src="Screenshot__51_-removebg-preview.png" alt="My Dynamic CV Logo">
            </div>
            <div class="nav">
            <ul class="nav-links" id="nav-menu">
                <li><a href="register.html" id="home-link">Home</a></li>
                <li><a href="#abouts" id="about-link">About</a></li>
                <li><a href="#how-it" id="service-link">Service</a></li>
                <li><a href="#testimonials" id="testimonial-link">Testimonial</a></li>
                <li><a href="#faq" id="faq-link">FAQ</a></li>
                <li><a href="#contact" id="contact-link">Contact</a></li>
            </ul></div>
            
        </header>

        <div id="resume-section" class="resume-section">
            <h2>Interactive Resume Creator</h2>
            <p>Welcome to the resume creation section! Here, you can add all your details to build your personalized
                resume.
            </p>
        </div>

        <div class="container">
            <div class="form-container" id="resumeFormContainer">
                <h2>Enter Your Details</h2>
                <form id="resumeForm">
                    <label for="profilePicUpload">Upload Profile Picture</label>
                    <input type="file" id="profilePicUpload">

                    <label for="name">Name</label>
                    <input type="text" id="name" placeholder="Enter your name">

                    <label for="jobTitle">Job Title</label>
                    <input type="text" id="jobTitle" placeholder="Enter your job title">

                    <label for="contact">Contact</label>
                    <input type="text" id="contact" placeholder="Enter your contact details">

                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email">

                    <label for="address">Address:</label>
                    <textarea id="address" name="address" rows="4" cols="40"
                        placeholder="Enter your full address..."></textarea>

                    <label for="skills">Skills (comma separated)</label>
                    <input type="text" id="skills"
                        placeholder="Enter your skills (e.g., Adaptability, Problem-Solving)">

                    <label for="languages">Languages (Select up to 7)</label>
                    <div class="language-dropdown-container">
                        <div class="language-checkbox-list">
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_en" name="languages" value="en">
                                <label for="lang_en">Tamil</label>
                                <select id="level_en" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_zh" name="languages" value="zh">
                                <label for="lang_zh">Chinese</label>
                                <select id="level_zh" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_es" name="languages" value="es">
                                <label for="lang_es">Urdu</label>
                                <select id="level_es" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_fr" name="languages" value="fr">
                                <label for="lang_fr">English</label>
                                <select id="level_fr" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>

                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_ru" name="languages" value="ru">
                                <label for="lang_ru">Hindi</label>
                                <select id="level_ru" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_de" name="languages" value="de">
                                <label for="lang_de">German</label>
                                <select id="level_de" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_ar" name="languages" value="ar">
                                <label for="lang_ar">Arabic</label>
                                <select id="level_ar" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <div class="language-checkbox-item">
                                <input type="checkbox" id="lang_ja" name="languages" value="ja">
                                <label for="lang_ja">Japanese</label>
                                <select id="level_ja" class="language-level-select">
                                    <option value="basic">Basic</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="fluent">Fluent</option>
                                    <option value="native">Native</option>
                                </select>
                            </div>
                            <!-- Add more languages as needed -->
                        </div>
                    </div>

                    <label for="summary">Professional Summary</label>
                    <textarea id="summary" placeholder="Write a short professional summary"></textarea>

                    <label for="education">Education</label>
                    <textarea id="education" placeholder="Your education history"></textarea>

                    <label for="experience">Experience</label>
                    <textarea id="experience" placeholder="Your work experience"></textarea>

                    <!-- Removed Project Description Input -->

                    <label for="projectLink">Project Link</label>
                    <input type="text" id="projectLink" placeholder="Enter link to your project">

                    <div class="generate">
                        <button type="button" onclick="generateResume(event)">Generate Resume</button>
                        <button type="button" onclick="downloadPDF()" class="download-button">Download PDF</button>
                    </div>
                </form>
            </div>
            <div id="resumeContent"></div>


        </div>
        <footer>
            <p>© 2025 Interactive Resume. All Rights Reserved.</p>
          </footer>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script>
        
        let generatedResumeHTML = '';
        let resumeData = null;

        async function generateResume(event) {
            event.preventDefault();

            // Get form values
            const name = document.getElementById("name").value;
            const jobTitle = document.getElementById("jobTitle").value;
            const contact = document.getElementById("contact").value;
            const email = document.getElementById("email").value;
            const address = document.getElementById("address").value;
            const skills = document.getElementById("skills").value;

            const languages = Array.from(document.querySelectorAll('input[name="languages"]:checked'))
                .map(checkbox => {
                    const langCode = checkbox.value;
                    const level = document.getElementById(`level_${langCode}`).value;
                    return { code: langCode, level: level, label: checkbox.labels[0].textContent };
                });

            const summary = document.getElementById("summary").value;
            const education = document.getElementById("education").value;
            const experience = document.getElementById("experience").value;
            const profilePic = document.getElementById("profilePicUpload").files[0];

            let projectLink = document.getElementById("projectLink").value;

            // Validation
            let missingFields = [];
            if (!name) missingFields.push("Name");
            if (!jobTitle) missingFields.push("Job Title");
            if (!contact) missingFields.push("Contact");
            if (!email) missingFields.push("Email");
            if (!address) missingFields.push("Address");
            if (!skills) missingFields.push("Skills");
            if (!summary) missingFields.push("Summary");
            if (!education) missingFields.push("Education");
            if (!experience) missingFields.push("Experience");

            if (missingFields.length > 0) {
                alert("Please fill in the following fields:\n" + missingFields.join("\n"));
                return;
            }


            if (projectLink && !projectLink.startsWith('https://') && !projectLink.startsWith('http://')) {
                projectLink = 'https://' + projectLink;
            }

            let profilePicURL = "";
            if (profilePic) {
                profilePicURL = await new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsDataURL(profilePic);
                });
            }

            const skillsList = skills.split(',').map(skill => `<li>${skill.trim()}</li>`).join('');

            const languageList = languages.map(lang => `
                <li>${lang.label}
                    <div class="language-dots">${getLanguageDots(lang.level)}</div>
                </li>
            `).join('');

            let contactInfo = `
               <p>${contact}</p>
               <p>${email}</p>
            `;

            let projectSection = '';

            if (projectLink) {
                projectSection += `<div class="section"><h3>Project link</h3>`;
                projectSection += `<p><a href="${projectLink}" target="_blank">${projectLink}</a></p>`;
                projectSection += '</div>';
            }

            // Fetch Projects from URL
            const projectsURL = 'projects.json'; // Replace with your actual URL
            let projectsList = '<p>No projects listed.</p>';

            try {
                const response = await fetch(projectsURL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const projectsData = await response.json();

                if (Array.isArray(projectsData) && projectsData.length > 0) {
                    projectsList = projectsData.map(project => `
                        <div>
                            <h4>${project.title}</h4>
                            <p>${project.description}</p>
                            ${project.link ? `<a href="${project.link}" target="_blank">View Project</a>` : ''}
                        </div>
                    `).join('');
                    projectSection = `<div class="section"><h3>Projects</h3>${projectsList}</div>`; // Add whole section
                } else {
                    console.warn("No projects data found in the JSON file.");
                }
            } catch (error) {
                console.error("Error fetching projects:", error);
                projectsList = '<p>No projects listed.</p>'; // Error display
            }

              // Fetch Achievements from URL
            const achievementsURL = 'achievements.json'; // Replace with your actual URL
            let achievementsList = null; // Initialize to null
            let achievementsSection = ''; // Initialize the achievements section

            try {
                const response = await fetch(achievementsURL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const achievementsData = await response.json();

                if (Array.isArray(achievementsData) && achievementsData.length > 0) {
                    achievementsList = achievementsData.map(achievement => `<li>${achievement}</li>`).join('');
                    achievementsSection = `<div class="section"><h3>Achievements</h3><ul>${achievementsList}</ul></div>`;
                } else {
                    console.warn("No achievements data found in the JSON file.");
                    achievementsList = null;
                }
            } catch (error) {
                console.error("Error fetching achievements:", error);
                achievementsList = null;
            }

            const sortedLanguages = [...languages].sort((a, b) => {
                if (a.code === 'en') return -1;
                if (b.code === 'en') return 1;
                if (a.code === 'zh') return -1;
                if (b.code === 'zh') return 1;
                return 0;
            });

            const languageListSorted = sortedLanguages.map(lang => `
                <li>${lang.label}
                    <div class="language-dots">${getLanguageDots(lang.level)}</div>
                </li>
            `).join('');

            generatedResumeHTML = `
                <div class="resume-container">
                    <div class="top-section">
                        <div class="profile-image-container">
                            <img src="${profilePicURL ? profilePicURL : 'placeholder.jpg'}" alt="Profile Picture">
                        </div>
                        <div class="header-text">
                            <h1>${name}</h1>
                            <h4>${jobTitle}</h4>
                        </div>
                    </div>
                    <div class="section1">
                        <div class="left-section">
                            <div class="section contact-info">
                                <h3>Contact</h3>
                                 ${contactInfo}
                            </div>

                            <div class="section">
                                <h3>Skills</h3>
                                <ul class="skills-ul">${skillsList}</ul>
                            </div>
                            <div class="section">
                                <h3>Languages</h3>
                                <ul class="languages-ul">${languageListSorted}</ul>
                            </div>

                            <div class="section">
                                <h3>Professional Summary</h3>
                                <p>${summary}</p>
                            </div>
                        </div>
                        <div class="right-section">

                            <div class="section">
                                <h3>Education</h3>
                                <p>${education}</p>
                            </div>
                            <div class="section">
                                <h3>Experience</h3>
                                <p>${experience}</p>
                            </div>
                            ${achievementsSection}
                           ${projectSection}
                        </div>
                    </div>
                </div>
            `;

            document.getElementById("resumeContent").innerHTML = generatedResumeHTML;
            document.getElementById("resumeContent").classList.add("visible");
            document.getElementById("resumeContent").style.display = "block";
        }

        function getLanguageDots(level) {
            let dots = "";
            let levels = {
                "basic": 1,
                "conversational": 2,
                "fluent": 3,
                "native": 4
            };

            for (let i = 0; i < 4; i++) {
                dots += `<span class="dot" style="background-color: ${i < levels[level] ? '#5cb85c' : '#ccc'};"></span>`;
            }
            return dots;
        }

        function downloadPDF() {
            if (!generatedResumeHTML) {
                alert("Please generate your resume first.");
                return;
            }
            const resumeContent = document.getElementById("resumeContent");

            resumeContent.classList.add('pdf-background-gradient');

            html2pdf(resumeContent, {
                margin: 10,
                filename: 'My_Resume.pdf',
                image: {
                    type: 'jpeg',
                    quality: 0.98
                },
                html2canvas: {
                    scale: 2
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait'
                }
            }).then(() => {
                resumeContent.classList.remove('pdf-background-gradient');
            });
            
        }


        function openModal(fullImage, altText) {
            document.getElementById("imageModal").style.display = "block";
            document.getElementById("img01").src = fullImage;
            document.getElementById("caption").innerHTML = altText;
        }

        function closeModal() {
            document.getElementById("imageModal").style.display = "none";
        }
        
    </script>
</body>

</html>